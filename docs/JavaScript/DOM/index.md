# DOM

Язык JavaScript изначально был создан для веб-браузеров. Но с тех пор он значительно эволюционировал и превратился в кроссплатформенный язык программирования для решения широкого круга задач.

Сегодня JavaScript может использоваться в браузере, на веб-сервере или в какой-то другой среде, даже в кофеварке. Каждая среда предоставляет свою функциональность, которую спецификация JavaScript называет окружением.

Окружение предоставляет свои объекты и дополнительные функции, в дополнение базовым языковым. Браузеры, например, дают средства для управления веб-страницами. Node.js делает доступными какие-то серверные возможности и так далее. 


Корневой объект `window`, который выступает в 2 ролях:

* Во-первых, это глобальный объект для JavaScript-кода
* Во-вторых, он также представляет собой окно браузера и располагает методами для управления им.

Например, здесь мы используем window как глобальный объект: 
```js
function sayHi() {
    alert("Hello");
}

window.sayHi(); // (1)!
```

1.  :man_raising_hand: глобальные функции доступны как методы глобального объекта

А здесь мы используем `window` как объект окна браузера, чтобы узнать его высоту:
```js
alert(window.innerHeight); // внутренняя высота окна браузера (625 на ноутбуке)
```

``` mermaid
graph TD
  A[window] -->|DOM| B[document];
  A[window] -->|BOM| C[navigator...];
  A[window] -->|JavaScript| D[Object];
```

## Document Object Model
Document Object Model, сокращённо DOM – объектная модель документа, которая представляет все содержимое страницы в виде объектов, которые можно менять.  
По сути, она связывает веб-страницы со скриптами или языками программирования.

``` mermaid
graph LR
  A[HTML] --> B((DOM));
  C[JavaScript] --> B[DOM];
  B((DOM)) <--> D[Браузер];
  D[Браузер] <--> B((DOM));
```

Браузер создаёт DOM на основе HTML-кода страницы. Затем на основе DOM и других структур, браузер рисует страницу пользователю. При изменении DOM, браузер анализирует это и обновляет страницу.

Объект `document` – основная «входная точка». С его помощью мы можем что-то создавать или менять на странице.  

```js
// заменим цвет фона на красный,
document.body.style.background = "red"; 
// а через секунду вернём как было
setTimeout(() => document.body.style.background = "", 1000);
```

## CSSOM для стилей

Правила стилей CSS структурированы иначе чем HTML. Для них есть отдельная спецификация CSSOM, которая объясняет, как стили должны представляться в виде объектов, как их читать и писать. CSSOM используется вместе с DOM при изменении стилей документа.


## BOM

Объектная модель браузера (Browser Object Model, BOM) – это дополнительные объекты, предоставляемые браузером (окружением), чтобы работать со всем, кроме документа.

Например:

* Объект `navigator` даёт информацию о самом браузере и операционной системе. Среди множества его свойств самыми известными являются: `navigator.userAgent` – информация о текущем браузере, и `navigator.platform` – информация о платформе (может помочь в понимании того, в какой ОС открыт браузер – Windows/Linux/Mac и так далее).
* Объект `location` позволяет получить текущий URL и перенаправить браузер по новому адресу. 

```js
alert(location.href); // показывает текущий URL
if (confirm("Перейти на Wikipedia?")) {
    location.href = "https://wikipedia.org"; // перенаправляет браузер на другой URL
}
```

Функции `alert/confirm/prompt` тоже являются частью BOM: они не относятся непосредственно к странице, но представляют собой методы объекта окна браузера для коммуникации с пользователем.

!!! info "Важно запомнить!"

    * Пробелы и переводы строки – это полноправные символы, как буквы и цифры. Они образуют текстовые узлы и становятся частью дерева DOM.
    * Автоисправление - При генерации DOM браузер самостоятельно обрабатывает ошибки в документе, закрывает теги и так далее.
    * Таблицы всегда содержат `<tbody>` - Из пустоты появился `<tbody>`, как будто документ и был таким. Важно знать об этом, иначе при работе с таблицами возможны сюрпризы.
    * Все, что есть в HTML, даже комментарии, является частью DOM.
    * В мире DOM null означает «не существует»
